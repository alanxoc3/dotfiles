#!/bin/bash

diff -u "$1" "$2" | diff-so-fancy | kak -e '
  # From my testing, this hook only works with buffer, which means that I cannot move the cursor.
  hook buffer BufCloseFifo .* %{
    ansi-render
  }

  # I do not know another way to get the cursor to the top. This NormalIdle feels hacking, but it worked so far.
  # For some reason ansi-render sometimes moves the cursor. Who knows why.
  hook -group stdinen window NormalIdle .* %{
    execute-keys gg
    remove-hooks window stdinen
  }
'
